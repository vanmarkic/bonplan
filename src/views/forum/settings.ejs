<%- include('../partials/header', { title: 'Param√®tres - Le Syndicat des Tox' }) %>

<h2>Param√®tres du compte</h2>

<% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-error">
        <%= error %>
    </div>
<% } %>

<% if (typeof success !== 'undefined' && success) { %>
    <div class="alert alert-success">
        <%= success %>
    </div>
<% } %>

<div style="max-width: 800px;">
    <!-- Account Information Section -->
    <section style="margin-bottom: 3rem;">
        <h3>Informations du compte</h3>
        <div style="background: #f9f9f9; padding: 1.5rem; border-radius: 4px; margin-top: 1rem;">
            <p><strong>Pseudo:</strong> <%= user.pseudo %></p>
            <p><strong>Membre depuis:</strong> <%= new Date(user.createdAt).toLocaleDateString('fr-BE', { year: 'numeric', month: 'long', day: 'numeric' }) %></p>
            <p><strong>Langue pr√©f√©r√©e:</strong>
                <% if (user.preferredLanguage === 'fr') { %>Fran√ßais
                <% } else if (user.preferredLanguage === 'nl') { %>Nederlands
                <% } else if (user.preferredLanguage === 'de') { %>Deutsch
                <% } else if (user.preferredLanguage === 'en') { %>English
                <% } %>
            </p>
            <% if (user.isModerator) { %>
                <p class="moderator-badge">üõ°Ô∏è Mod√©rateur</p>
            <% } %>
        </div>
    </section>

    <!-- Language Settings Section -->
    <section style="margin-bottom: 3rem;">
        <h3>Pr√©f√©rences</h3>
        <form method="POST" action="/forum/settings/language">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">

            <div class="form-group">
                <label for="language">Langue de l'interface:</label>
                <select id="language" name="language">
                    <option value="fr" <%= user.preferredLanguage === 'fr' ? 'selected' : '' %>>Fran√ßais</option>
                    <option value="nl" <%= user.preferredLanguage === 'nl' ? 'selected' : '' %>>Nederlands</option>
                    <option value="de" <%= user.preferredLanguage === 'de' ? 'selected' : '' %>>Deutsch</option>
                    <option value="en" <%= user.preferredLanguage === 'en' ? 'selected' : '' %>>English</option>
                </select>
                <p class="text-small">La langue utilis√©e pour les menus et les messages du forum</p>
            </div>

            <button type="submit" class="btn">
                üíæ Enregistrer les pr√©f√©rences
            </button>
        </form>
    </section>

    <!-- Privacy & Data Section -->
    <section style="margin-bottom: 3rem;">
        <h3>Confidentialit√© et donn√©es</h3>
        <div class="alert alert-info">
            <p><strong>üîí Votre vie priv√©e est notre priorit√©</strong></p>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Nous ne collectons AUCUNE adresse IP</li>
                <li>Aucun email ou donn√©e personnelle stock√©e</li>
                <li>Sessions s√©curis√©es, chiffr√©es end-to-end</li>
                <li>H√©bergement en Belgique (GDPR compliant)</li>
            </ul>
        </div>

        <div style="margin-top: 1.5rem;">
            <h4>Vos droits RGPD</h4>
            <p>Conform√©ment au R√®glement G√©n√©ral sur la Protection des Donn√©es (RGPD), vous disposez des droits suivants:</p>

            <div style="margin-top: 1rem;">
                <a href="/forum/export" class="btn btn-secondary">
                    üì• Exporter mes donn√©es
                </a>
                <p class="text-small" style="margin-top: 0.5rem;">
                    T√©l√©chargez toutes vos discussions et r√©ponses au format JSON
                </p>
            </div>

            <div style="margin-top: 1.5rem;">
                <a href="/forum/delete-account" class="btn btn-danger">
                    üóëÔ∏è Supprimer mon compte
                </a>
                <p class="text-small" style="margin-top: 0.5rem;">
                    Suppression d√©finitive de votre compte et de tout votre contenu
                </p>
            </div>
        </div>
    </section>

    <!-- Security Section -->
    <section style="margin-bottom: 3rem;">
        <h3>S√©curit√©</h3>
        <div style="background: #f9f9f9; padding: 1.5rem; border-radius: 4px;">
            <h4>‚ö†Ô∏è √Ä propos de votre code PIN</h4>
            <p>Votre code PIN est chiffr√© avec Argon2id et ne peut pas √™tre r√©cup√©r√©.</p>
            <p style="margin-top: 0.5rem;"><strong>Si vous oubliez votre PIN, votre compte sera d√©finitivement perdu.</strong></p>
            <p style="margin-top: 0.5rem;" class="text-small">
                Par design, il n'existe aucun moyen de r√©initialiser votre PIN. Ceci garantit que personne (y compris les administrateurs) ne peut acc√©der √† votre compte.
            </p>
        </div>

        <div style="margin-top: 1.5rem; background: #fff3cd; padding: 1rem; border-radius: 4px; border: 1px solid #ffc107;">
            <h4 style="color: #856404;">üí° Conseils de s√©curit√©</h4>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: #856404;">
                <li>Notez votre PIN dans un endroit s√ªr</li>
                <li>Ne partagez jamais votre PIN avec qui que ce soit</li>
                <li>D√©connectez-vous toujours sur les ordinateurs partag√©s</li>
                <li>N'utilisez pas ce forum sur un r√©seau Wi-Fi public non s√©curis√©</li>
            </ul>
        </div>
    </section>

    <!-- Account Statistics (Optional) -->
    <section style="margin-bottom: 3rem;">
        <h3>Statistiques</h3>
        <div style="background: #f9f9f9; padding: 1.5rem; border-radius: 4px;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                <div>
                    <p class="text-small">Discussions cr√©√©es</p>
                    <p style="font-size: 1.5rem; font-weight: 600; color: #3498db;"><%= typeof stats !== 'undefined' ? stats.threadCount : 0 %></p>
                </div>
                <div>
                    <p class="text-small">R√©ponses post√©es</p>
                    <p style="font-size: 1.5rem; font-weight: 600; color: #2ecc71;"><%= typeof stats !== 'undefined' ? stats.replyCount : 0 %></p>
                </div>
                <div>
                    <p class="text-small">Jours actifs</p>
                    <p style="font-size: 1.5rem; font-weight: 600; color: #9b59b6;">
                        <%= typeof stats !== 'undefined' ? Math.floor((new Date() - new Date(user.createdAt)) / (1000 * 60 * 60 * 24)) : 0 %>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Help & Resources -->
    <section style="margin-bottom: 3rem;">
        <h3>Aide et ressources</h3>
        <div style="background: #e74c3c; color: #fff; padding: 1.5rem; border-radius: 4px;">
            <h4 style="color: #fff;">üÜò Besoin d'aide d'urgence?</h4>
            <p style="margin-top: 0.5rem;">
                <strong>Centre de Pr√©vention du Suicide:</strong> 0800 32 123 (24/7, gratuit et anonyme)<br>
                <strong>Zelfmoordlijn:</strong> 1813 (24/7)<br>
                <strong>Urgences:</strong> 112
            </p>
            <a href="/forum/resources" style="display: inline-block; margin-top: 1rem; padding: 0.5rem 1rem; background: #fff; color: #e74c3c; text-decoration: none; border-radius: 4px; font-weight: 600;">
                Voir toutes les ressources d'aide
            </a>
        </div>
    </section>
</div>

<%- include('../partials/footer') %>
